# 一条SQL语句的执行过程

![](https://github.com/ZH1995/note/blob/main/MySQL/img/mysql_arch.png) 



**连接器**：与MySQL建立连接，用户鉴权。

**查询缓存**：开启后，以查询语句做key，查询缓存。由于表数据只要发生变更，就会触发缓存清除，建议关闭。

**分析器**：词法分析解析出表名、列名等；语法分析检查是否符合MySQL语法。

**优化器**：选择索引、连表顺序等最佳查询方案。

**执行器**：调用存储层具体存储引擎的读写接口，获取存储数据。

# 事务隔离

**事务特性**：原子性、一致性、隔离性、持久性。

**隔离级别**：

- 读未提交：一个事务还未提交时，它做的变更就能够被别的事务看到。
- 读已提交：一个事务提交后，它做的变更才能被别的事务看到。
- 可重复读：一个事务执行过程中，前后看到的数据保持一致。
- 串行化：对于同一行记录，写会加写锁，读加读锁。当出现读写冲突时，后访问的事务必须等前一个事务执行完成，才能继续执行。

#### 事务的启动方式

- 显示：start transaction或begin，提交commit，回滚rollback。
- 隐式：set autocommit=0，只要执行select就会启动事务。该事务不会自动提交，直到主动执行commit或rollback语句或断开连接。
